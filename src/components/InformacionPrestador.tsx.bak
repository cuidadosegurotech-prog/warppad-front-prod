
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Input } from "@/components/ui/input";
import { useState } from "react";

interface Prestador {
  nombre: string;
  nit: string;
}

interface InformacionPrestadorProps {
  regional: string;
  prestador: string;
  onRegionalChange?: (value: string) => void;
  onPrestadorChange?: (value: string) => void;
  bBloquear?: boolean;
}

const prestadoresPorRegional: Record<string, Prestador[]> = {
  2023: [
    { nombre: "CLINICA MAR CARIBE", nit: "819003210-5" },
    { nombre: "EFISALUD SAS", nit: "804009739-1" },
    { nombre: "ESE ALEJANDRO PROSPERON", nit: "891780009" },
    { nombre: "FUNDACION OFTALMOLOGICA DEL CARIBE", nit: "8001127254" },
    { nombre: "FUNDACION PROMAGDALENA", nit: "9001469274" },
    { nombre: "IMAGENOLOGIA DEL MAGDALENA", nit: "9003028433" },
    { nombre: "IPS SURGIFAST", nit: "819006339-1" },
    { nombre: "IRECA IPS", nit: "901659987" },
    { nombre: "OLARIS RIVAS RIVAS IPS", nit: "9002562279" },
    { nombre: "PROFAMILIA", nit: "8600137795" },
    { nombre: "VIVA 1A IPS", nit: "900219120-2" }
  ],
  2025: [
  { nombre: "BONADONA", nit: null },
  { nombre: "CLINICA CENTRO", nit: "822021332-1" },
  { nombre: "CLINICA DE LA COSTA", nit: "800129856-5" },
  { nombre: "CLINICA GENERAL SAN DIEGO", nit: "900600256" },
  { nombre: "CLINICA PORTO AZUL AUNA", nit: null },
  { nombre: "CLINICA SAN IGNACIO", nit: "800025755" },
  { nombre: "CLINICA SAN MARTIN", nit: "802021332-1" },
  { nombre: "CLINICA SAN RAFAEL ALTA COMPLEJIDAD", nit: null },
  { nombre: "FUNDACION ADELA DE CHAR", nit: "806008394" },
  { nombre: "FUNDACION CAMPBELL", nit: "900002080" },
  { nombre: "HOSPITAL UNIVERSIDAD DEL NORTE", nit: "890112801-3" },
  { nombre: "MIRED BARRANQUILLA IPS S.A.S.", nit: "901139193-1" },
  { nombre: "ORGANIZACIÓN GENERAL DEL NORTE", nit: "890102768" },
  { nombre: "PORVENIR", nit: "802519073" }
],
2006: [
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER ARROYO HONDO", nit: "8060083947" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER CALAMAR", nit: "8060083947" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER CORDOBA", nit: "8060083947" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER EL CARMEN DE BOLIVAR", nit: "8060083947" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER GUAMO", nit: "8060083947" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER SAN JACINTO", nit: "8060083947" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER SAN JUAN NEPOMUCENO", nit: "8060083947" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER ZAMBRANO", nit: "8060083947" },
  { nombre: "CLINICA CRECER", nit: "806004548-6" },
  { nombre: "CLINICA DE LA MUJER CARTAGENA S.A.S.", nit: "901031682-4" },
  { nombre: "CLINICA ESPECIALIZADA LA CONCEPCION S.A.S.", nit: "830510991-3" },
  { nombre: "CLINICA SALUD SOCIAL SA.S", nit: "823002991" },
  { nombre: "ESE HOSPITAL LOCAL DE SAN JUAN NEPOMUCENO", nit: "806006414-7" },
  { nombre: "ESE HOSPITAL NUESTRA SEÑORA DEL CARMEN", nit: "900196346-9" },
  { nombre: "HOSPITAL LOCAL DE SAN JACINTO BOLIVAR", nit: "806007303-1" }
],
1: [
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER ARJONA", nit: "806008394-7" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER CARTAGENA", nit: "806008394-7" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER MARIA LA BAJA", nit: "806008394-7" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER TURBACO", nit: "806008394-7" },
  { nombre: "ATENCIÓN AL USUARIO MUTUAL SER TURBANA", nit: "806008394-7" },
  { nombre: "CENTRO COLOMBIANO DE EPILEPSIA Y ENFERMEDADES NEUROLOGICASFIRE", nit: null },
  { nombre: "ClINICA BLAS DE LEZO S.A.S", nit: "890400693" },
  { nombre: "CLINICA CARTAGENA DEL MAR", nit: "806008439-1" },
  { nombre: "CLINICA CRECER", nit: "806004548-6" },
  { nombre: "CLINICA DE LA MUJER CARTAGENA S.A.S.", nit: "901031682-4" },
  { nombre: "CLINICA LA ERMITA", nit: "900491883" },
  { nombre: "CLINICA LA NUESTRA", nit: "805023423" },
  { nombre: "CLINICA MADRE BERNARDA", nit: "860028947-1" },
  { nombre: "CLINICA SAN JOSE DE TORICES", nit: "900304958" },
  { nombre: "CLINICA SANTA CRUZ DE BOCAGRANDE", nit: "806008356-7" },
  { nombre: "ESE HOSPITAL UNIVERSITARIO DEL CARIBE", nit: "900042103" },
  { nombre: "ESTRIOS S.A.S", nit: "806011261-7" },
  { nombre: "HOSPITAL SERENA DEL MAR", nit: "900482242-8" },
  { nombre: "IPS INTEGRAL CLINICA CARE S.A.S", nit: "901434501-1" },
  { nombre: "IPS SALUD Y BIENESTAR DEL CARIBE", nit: "900674295" },
  { nombre: "MEDIHELP SERVICES COLOMBIA", nit: "830066626-5" },
  { nombre: "NEURODINAMIA S.A", nit: "806013568" }
],
2024: [
  { nombre: "CLINICA DE LA COSTA", nit: "9006002568" },
  { nombre: "CLINICA DE LOS RIOS", nit: "900638867" },
  { nombre: "CLINICA DE SALUD SOCIAL", nit: "823002991-9" },
  { nombre: "CLINICA GENERAL SAN DIEGO", nit: "9006002568" },
  { nombre: "CLINICA IMAT", nit: "901085352" },
  { nombre: "CLINICA LA CONCEPCION", nit: "830510991-3" },
  { nombre: "CLINICA LA ERMITA", nit: "900491883" },
  { nombre: "CLINICA PORTO AZUL", nit: "900248882-1" },
  { nombre: "CLINICA SAN MARTIN", nit: "900638867" },
  { nombre: "CLINICA UNIVERSITARIA MEDICINA INTEGRAL SAS", nit: "900740827" },
  { nombre: "FUNDACION AMIGOS DE LA SALUD", nit: "812005522-1" },
  { nombre: "HOSPITAL LA DIVINA MISERICORDIA", nit: "900196347-6" },
  { nombre: "HOSPITAL UNIVERDIAD DEL NORTE", nit: "890112801-3" },
  { nombre: "HOSPITAL UNIVERSITARIO DEL CARIBE", nit: "900491883" },
  { nombre: "ICARE", nit: "901434501-1" },
  { nombre: "MUTUAL ACHI", nit: "806008394-7" },
  { nombre: "MUTUAL CICUCO", nit: "806008394-7" },
  { nombre: "MUTUAL MAGANGUE", nit: "806008394-7" },
  { nombre: "MUTUAL MOMPOS", nit: "806008394-7" },
  { nombre: "MUTUAL MONTECRISTO", nit: "806008394-7" },
  { nombre: "MUTUAL PINILLO", nit: "806008394-7" },
  { nombre: "MUTUAL SAN JACINTO DEL CAUCA", nit: "806008394-7" },
  { nombre: "MUTUAL SIMITI", nit: "806008394-7" },
  { nombre: "MUTUAL TALAIGUA", nit: "806008394-7" },
  { nombre: "MUTUAL TIQUISIO", nit: "806008394-7" },
  { nombre: "SEDARTE", nit: "9007720141" }
],
2027: [
  { nombre: "ATENCION AL USUARIO MUTUAL SER VALLEDUPAR", nit: "806008394-7" },
  { nombre: "CLINICA BUENOS AIRES", nit: "824002277" },
  { nombre: "CLINICA LAURA DANIELA", nit: "900008328-1" }
],
5: [
  { nombre: "ACCION SALUD", nit: "900162712" },
  { nombre: "ATENCION AL USUARIO MUTUAL SER COTORRA", nit: "8060083947" },
  { nombre: "ATENCION AL USUARIO MUTUAL SER LORICA", nit: "8060083947" },
  { nombre: "ATENCION AL USUARIO MUTUAL SER MONTERIA", nit: "8060083947" },
  { nombre: "ATENCION AL USUARIO MUTUAL SER PLANETA RICA", nit: "8060083947" },
  { nombre: "ATENCION AL USUARIO TIERRALTA", nit: "8060083947" },
  { nombre: "CENTRO REGULADOR SABANA SALUD", nit: "9003981517" },
  { nombre: "CLINICA DEL RIO", nit: "900540156-1" },
  { nombre: "CLINICA FUNDACION AMIGOS DE LA SALUD", nit: "812005522-1" },
  { nombre: "CLINICA IMAT ONCOMEDICA AUNA", nit: "901085352-0" },
  { nombre: "CLINICA LA ESPERANZA", nit: "900955-6" },
  { nombre: "CLINICA LA TRINIDAD", nit: "8120029585" },
  { nombre: "CLINICA UNIVERSITARIA MEDICINA INTEGRAL", nit: "900740827-3" },
  { nombre: "ESE HOSPITAL SAN DIEGO", nit: "891080015" },
  { nombre: "ESE HOSPITAL SAN JERONIMO", nit: "891079999-5" },
  { nombre: "ESE HOSPITAL SAN VICENTE DE PAUL", nit: "800204153" },
  { nombre: "MEDISINU", nit: "900931343-0" },
  { nombre: "NIÑOS DE PAPEL", nit: "800099778-9" },
  { nombre: "SISACOR", nit: "900607207" },
  { nombre: "VIVA 1A", nit: "900219120-2" }
]
};

export default function InformacionPrestador({
  regional,
  prestador,
  onRegionalChange,
  onPrestadorChange,
  bBloquear
}: InformacionPrestadorProps) {
  const [search, setSearch] = useState("");
  const [prestadoresRegional, setPrestadoresRegional] = useState([]);
  console.log("InformacionPrestador - regional:", regional);
  console.log("InformacionPrestador - prestador:", prestador);

  let prestadoresDisponibles = prestadoresPorRegional[regional] || [];

  const handleRegionalChange = (value: string) => {
    console.log("Cambio de regional a:", value);
    onRegionalChange(value);
    prestadoresDisponibles = prestadoresPorRegional[value]
    setPrestadoresRegional(prestadoresDisponibles);
    // Limpiar el prestador seleccionado cuando cambia la regional
    //onPrestadorChange("");
  };

  const handlePrestadorChange = (value: string) => {
    console.log("Cambio de prestador a:", value);
    onPrestadorChange(value);
  };

  const handleSearchPrestador = (value: string)=>{
    console.log(value);
    console.table(prestadoresPorRegional[regional]);
    const vObjPrestadoresRegional = value.length != 0 ?  prestadoresPorRegional[regional].filter(item => item.nit.includes(value.toUpperCase()) || item.nombre.includes(value.toUpperCase())) : prestadoresPorRegional[regional];
    setPrestadoresRegional(vObjPrestadoresRegional);
  };

  return (
    <div className="space-y-6">
      <div>
        <h3 className="text-lg font-semibold text-slate-800 mb-4">Información del Prestador</h3>
      </div>

      {/* Regional */}
      <div className="space-y-2">
        <Label htmlFor="regional" className="text-slate-800 font-medium">
          Solicitud asignada a la regional
          <span className="text-red-500"> *</span>
        </Label>
        <Select value={regional} onValueChange={handleRegionalChange} disabled={bBloquear}>
          <SelectTrigger className="bg-white border-slate-200 text-slate-800 focus:border-blue-400 focus:ring-blue-400/20">
            <SelectValue placeholder="Selecciona la regional" />
          </SelectTrigger>
          <SelectContent className="bg-white border-slate-200 shadow-lg z-[100]">
            <SelectItem value="1" className="text-slate-800 hover:bg-slate-50 bg-white">
              Bolivar Norte
            </SelectItem>
             <SelectItem value="2006" className="text-slate-800 hover:bg-slate-50 bg-white">
              Bolivar Centro
            </SelectItem>
            <SelectItem value="2024" className="text-slate-800 hover:bg-slate-50 bg-white">
              Bolivar Sur
            </SelectItem>
            <SelectItem value="2025" className="text-slate-800 hover:bg-slate-50 bg-white">
              Atlantico
            </SelectItem>
            <SelectItem value="3" className="text-slate-800 hover:bg-slate-50 bg-white">
              Magdalena
            </SelectItem>
            <SelectItem value="2023" className="text-slate-800 hover:bg-slate-50 bg-white">
              Banco Magdalena
            </SelectItem>
            <SelectItem value="2027" className="text-slate-800 hover:bg-slate-50 bg-white">
              Cesar
            </SelectItem>
            <SelectItem value="5" className="text-slate-800 hover:bg-slate-50 bg-white">
              Cordoba
            </SelectItem>
          </SelectContent>
        </Select>
      </div>

      {/* Prestador */}
      {/* <div className="space-y-2">
        <Label htmlFor="prestador" className="text-slate-800 font-medium">
          Prestador
          <span className="text-red-500"> *</span>
        </Label>
        <Select value={prestador} onValueChange={handlePrestadorChange} disabled={!regional}>
          <SelectTrigger className="bg-white border-slate-200 text-slate-800 focus:border-blue-400 focus:ring-blue-400/20 disabled:opacity-50">
            <SelectValue placeholder={regional ? "Selecciona el prestador" : "Primero selecciona una regional"} />
          </SelectTrigger>
          <SelectContent enableSearch={true} onSearchChange={handleSearchPrestador} className="bg-white border-slate-200 shadow-lg z-[100] max-h-[200px] overflow-y-auto">
            {prestadoresRegional.map((prestador) => (
              <SelectItem 
                key={`${prestador.nombre} - ${prestador.nit}`} 
                value={`${prestador.nombre} - ${prestador.nit}`}
                className="text-slate-800 hover:bg-slate-50 bg-white cursor-pointer"
              >
                {prestador.nombre} - {prestador.nit}
              </SelectItem>
            ))}
          </SelectContent>
        </Select>
      </div> */}

      {/* Ciudad / Municipio del paciente */}
        <div className="space-y-2">
          <Label htmlFor="Prestador" className="text-slate-800 font-medium">
            Prestador <span className="text-red-500">*</span>
          </Label>
          <Input
            id="Prestador"
            type="text"
            placeholder="Nombre del prestador"
            value={prestador}
            onChange={(e) => handlePrestadorChange(e.target.value)}
            className="bg-white border-slate-200 text-slate-800 placeholder:text-slate-400 focus:border-blue-400 focus:ring-blue-400/20"
            required
          />
        </div>
    </div>
  );
}
